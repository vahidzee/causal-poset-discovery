# sample hard through matching, compute loss with hards, 
# compute gradient with softs with the same noise
