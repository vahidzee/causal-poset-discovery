---
program: train.py
name: permutation_methods
method: random
metric:
    goal: minimize
    name: permutation/backward_penalty
parameters:
    model.in_features:
        values: [3, 5, 10]

    trainer/permutation:
        values: [contrastive_div, gumbel_top_k]

    trainer.permutation.num_samples:
        values: [8, 32, 64]

    trainer.permutation_batch_size:
        values: [8, 32, 128]

    trainer.temperature:
        values: [0.5, 1.]

    trainer.temperature_scheduler:
        values: [constant, linear]

    trainer.max_epochs:
        values: [100, 500, 1000]

command:
    - ${env}
    - ./slurm/train_runner.sh
    - ${args_no_hyphens}
    - test_run=false
